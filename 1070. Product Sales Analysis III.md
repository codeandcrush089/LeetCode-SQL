# Problem 1070: Product Sales Analysis III
![Medium](https://img.shields.io/badge/Level-Medium-yellow?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/product-sales-analysis-iii/description/)

```sql
SELECT
    S.product_id,
    T.first_year,
    S.quantity,
    S.price
FROM
    Sales S
INNER JOIN
    -- Subquery T: Finds the first year of sale for each product
    (
        SELECT
            product_id,
            MIN(year) AS first_year -- Get the minimum year for each product
        FROM
            Sales
        GROUP BY
            product_id
    ) AS T
ON
    S.product_id = T.product_id -- Match the product
    AND S.year = T.first_year; -- Match the first year of sale for that product
```
---
## üßê Query Explanation

### 1. `SELECT S.product_id, T.first_year, S.quantity, S.price`

Selects the **product ID**, its **first sale year**, and the corresponding **quantity and price** from that first year‚Äôs sale record.


### 2. `FROM Sales S`

Uses the **Sales** table as the main data source with the alias **`S`**.


### 3. Subquery `T`

```sql
SELECT product_id, MIN(year) AS first_year
FROM Sales
GROUP BY product_id
```

* Groups sales by **product_id**.
* Finds the **earliest (minimum) year** each product was sold.
* Stores the result as a temporary table **`T`** with:

  * `product_id`
  * `first_year`


### 4. `INNER JOIN (Subquery) AS T`

Joins the main **Sales** table with the subquery result to match each product with its **first sale year**.


### 5. `ON S.product_id = T.product_id`

Matches rows where the **product IDs are the same**.


### 6. `AND S.year = T.first_year`

Ensures that only the **sales record from the first year of sale for each product** is selected.


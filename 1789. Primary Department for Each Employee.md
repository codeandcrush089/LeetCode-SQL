# Problems 1789: Primary Department for Each Employee
![Easy](https://img.shields.io/badge/Level-Easy-brightgreen?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/primary-department-for-each-employee/description/)

```sql
SELECT
  employee_id,
  department_id
FROM Employee
WHERE primary_flag = 'Y'
UNION DISTINCT
SELECT
  employee_id,
  department_id
FROM Employee
GROUP BY 1
HAVING COUNT(*) = 1;
```
## üßê Query Explanation

* **First SELECT** ‚Üí Gets employees whose **primary department is marked as 'Y'**.
* `UNION DISTINCT` ‚Üí Merges results and **removes duplicates**.
* **Second SELECT + HAVING COUNT(*) = 1** ‚Üí Finds employees who are linked to **only one department** (so it‚Äôs automatically their primary).
* `GROUP BY 1` ‚Üí Groups by **employee_id**.


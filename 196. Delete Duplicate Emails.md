# Problem 196: Delete Duplicate Emails
![Easy](https://img.shields.io/badge/Level-Easy-brightgreen?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/delete-duplicate-emails/)

```sql
DELETE P1
FROM 
    Person P1,
    Person P2
WHERE
    P1.email = P2.email AND P1.id > P2.id;

/* Example for standard SQL (less portable, but often necessary if multi-table DELETE is not available):
DELETE FROM Person
WHERE id IN (
    SELECT id
    FROM (
        SELECT 
            id,
            ROW_NUMBER() OVER (PARTITION BY email ORDER BY id) as rn
        FROM Person
    ) AS Ranked
    WHERE rn > 1
);
*/
```


---
## ðŸ§ Query Explanation

### **1. `DELETE P1`**

Specifies that rows will be deleted **from the first alias (`P1`)** of the `Person` table.



### **2. Self-join on the same table**

```sql
FROM Person P1, Person P2
```

Creates two references to the same table so rows can be compared **against each other**.



### **3. Match duplicate emails**

```sql
P1.email = P2.email
```

Finds rows that share the **same email address**.


### **4. Keep the smallest ID, delete the rest**

```sql
P1.id > P2.id
```

* `P2` represents the row to **keep** (smaller ID).
* `P1` represents the **duplicate row** (larger ID) that should be deleted.


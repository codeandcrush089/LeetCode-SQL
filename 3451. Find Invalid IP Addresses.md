# Problem 3451: Find Invalid IP Addresses
![Hard](https://img.shields.io/badge/Level-Hard-red)

```sql
WITH
  InvalidIPs AS (
    SELECT ip
    FROM Logs
    WHERE
      LENGTH(ip) - LENGTH(REPLACE(ip, '.', '')) != 3
      OR ip REGEXP '(^|\\.)0[0-9]'
      OR ip REGEXP '(^|\\.)([0-9]{4,}|[3-9][0-9]{2}|2[6-9][0-9]|25[6-9])(\\.|$)'
  )
SELECT ip, COUNT(*) AS invalid_count
FROM InvalidIPs
GROUP BY ip
ORDER BY invalid_count DESC, ip DESC;
```

## ðŸ§ Query Explanation



* **`InvalidIPs` CTE** â†’ Filters out **invalid IP addresses** using 3 rules:

  1. `LENGTH(ip) - LENGTH(REPLACE(ip, '.', '')) != 3`
     â†’ IP must contain **exactly 3 dots**.
  2. `ip REGEXP '(^|\\.)0[0-9]'`
     â†’ Rejects **segments with leading zero** (e.g., `01`, `002`).
  3. `ip REGEXP '...25[6-9]'`
     â†’ Rejects **numbers > 255** in any IP segment.

* Final `SELECT`:

  * `COUNT(*) AS invalid_count` â†’ Counts **how many times each invalid IP appears**.
  * `GROUP BY ip` â†’ Groups by each invalid IP.
  * `ORDER BY invalid_count DESC, ip DESC` â†’ Most frequent invalid IPs first.


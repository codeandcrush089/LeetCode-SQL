# Problem 3421: Find Students Who Improved
![Medium](https://img.shields.io/badge/Level-Medium-yellow?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/find-students-who-improved/description/)

```sql
WITH
  RankedScores AS (
    SELECT
      student_id,
      subject,
      score,
      exam_date,
      RANK() OVER (PARTITION BY student_id, subject ORDER BY exam_date) AS rn_asc,
      RANK() OVER (PARTITION BY student_id, subject ORDER BY exam_date DESC) AS rn_desc
    FROM Scores
  ),
  FirstLastScores AS (
    SELECT
      student_id,
      subject,
      MIN(CASE WHEN rn_asc = 1 THEN score END) AS first_score,
      MAX(CASE WHEN rn_desc = 1 THEN score END) AS latest_score
    FROM RankedScores GROUP BY 1, 2
    HAVING COUNT(*) > 1
  )
SELECT student_id, subject, first_score, latest_score
FROM FirstLastScores
WHERE latest_score > first_score;
```
---
## ðŸ§ Query Explanation


* **`RankedScores` CTE**

  * For each *student + subject*, ranks scores by exam date:

    * `rn_asc = 1` â†’ **earliest exam score**
    * `rn_desc = 1` â†’ **latest exam score**

* **`FirstLastScores` CTE**

  * Extracts the earliest (`first_score`) and latest (`latest_score`) scores for every student & subject.
  * `HAVING COUNT(*) > 1` ensures the student has **more than one exam** in that subject.

* **Final query**

  * Returns only the subjects where the **latest score is higher than the first score**, meaning the student **improved**.




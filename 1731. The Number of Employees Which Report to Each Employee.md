# Problem 1731: The Number of Employees Which Report to Each Employee
![Easy](https://img.shields.io/badge/Level-Easy-brightgreen?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/the-number-of-employees-which-report-to-each-employee/description/)

```sql
SELECT
    m.employee_id,
    m.name,
    COUNT(e.employee_id) AS reports_count,
    ROUND(AVG(e.age)) AS average_age
FROM
    Employees AS e
INNER JOIN
    Employees AS m ON e.reports_to = m.employee_id
GROUP BY
    m.employee_id, m.name
ORDER BY
    m.employee_id;
```
---
## üßê Query Explanation

### **1. `FROM Employees e INNER JOIN Employees m ON e.reports_to = m.employee_id`**

* Joins the employee table to itself.
* `m` = manager
* `e` = employees who report to that manager
* This pairing allows us to calculate metrics **per manager**.



### **2. `SELECT m.employee_id, m.name`**

Returns the manager‚Äôs ID and name.



### **3. Count how many employees report to each manager**

```sql
COUNT(e.employee_id) AS reports_count
```

Counts **direct reports** for each manager.



### **4. Calculate average age of the direct reports**

```sql
ROUND(AVG(e.age)) AS average_age
```

Computes the average age of all employees reporting to the manager (rounded).



### **5. `GROUP BY m.employee_id, m.name`**

Groups all reporting employees under their respective manager.



### **6. `ORDER BY m.employee_id`**

Sorts the output by manager ID.



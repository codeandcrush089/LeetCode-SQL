```sql
-- Solution to find the top three unique salary earners (High Earners) in each department.
-- The DENSE_RANK() window function is used to handle ties correctly: 
-- employees with the same high salary share the same rank, and the next unique salary gets the next rank.

WITH RankedEmployees AS (
    -- 1. Calculate the rank of the salary within each department.
    SELECT
        E.departmentId,
        E.name AS Employee,
        E.salary AS Salary,
        -- DENSE_RANK assigns the same rank to employees with the same salary (tie)
        -- and ensures the rank skips are avoided, which is required for "unique salaries".
        DENSE_RANK() OVER (
            PARTITION BY E.departmentId
            ORDER BY E.salary DESC
        ) AS salary_rank
    FROM
        Employee E
)
-- 2. Select the results where the rank is 3 or less and join with Department for the name.
SELECT
    D.name AS Department,
    RE.Employee,
    RE.Salary
FROM
    RankedEmployees RE
JOIN
    Department D ON RE.departmentId = D.id
WHERE
    RE.salary_rank <= 3
ORDER BY
    D.name, RE.Salary DESC;
```

# Problem 1045: Customers Who Bought All Products.
![Medium](https://img.shields.io/badge/Level-Medium-yellow?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/customers-who-bought-all-products/description/)

```sql
SELECT
    customer_id
FROM
    Customer
GROUP BY
    customer_id  -- Group transactions by customer
HAVING
    -- Condition: The number of distinct products bought by the customer (A)
    -- must equal the total number of products available (B).
    COUNT(DISTINCT product_key) = (
        SELECT 
            COUNT(product_key) 
        FROM 
            Product
    );
```
---
## üßê Query Explanation

### üîπ 1. `SELECT customer_id`

* This selects only the **customer IDs**.
* Final output will be a list of customers who match the condition.


### üîπ 2. `FROM Customer`

* Data is taken from the **Customer table**, which contains purchase records.


### üîπ 3. `GROUP BY customer_id`

* Groups all purchase records **per customer**.
* So each customer is treated as a single group.

Example:
If customer `101` bought 5 products, all 5 rows are grouped together.


### üîπ 4. `COUNT(DISTINCT product_key)`

* Counts how many **unique products** each customer bought.
* `DISTINCT` ensures that:

  * If a customer bought the same product multiple times, it is counted **only once**.

This value = **A (products bought by customer)**


### üîπ 5. Subquery:

```sql
SELECT COUNT(product_key) FROM Product
```

* Counts **total number of products available** in the `Product` table.
* This is the **complete product catalog**.

This value = **B (total available products)**


### üîπ 6. `HAVING A = B`

```sql
COUNT(DISTINCT product_key) = (Total Products)
```

* Filters only those customers where:

  **Number of unique products they bought = Total products in store**

‚úÖ Means the customer bought **every single product**


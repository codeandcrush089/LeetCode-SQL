# Problem 1158: Market Analysis I
![Medium](https://img.shields.io/badge/Level-Medium-yellow?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/market-analysis-i/description/)

```sql
SELECT
    u.user_id AS buyer_id,
    u.join_date,
    -- Use SUM(CASE WHEN ...) to conditionally count the orders made in 2019
    SUM(CASE
        WHEN YEAR(o.order_date) = 2019 THEN 1
        ELSE 0
    END) AS orders_in_2019
FROM
    Users u
LEFT JOIN
    Orders o ON u.user_id = o.buyer_id
GROUP BY
    u.user_id, u.join_date
ORDER BY
    u.user_id; -- Added ORDER BY for consistent presentation, though 'any order' was allowed.
```
---
## üßê Query Explanation




### 1. `SELECT u.user_id AS buyer_id, u.join_date`

Selects each **user‚Äôs ID** (renamed as `buyer_id`) and their **join date**.


### 2. `SUM(CASE WHEN YEAR(o.order_date) = 2019 THEN 1 ELSE 0 END) AS orders_in_2019`

Conditionally counts the **number of orders placed in the year 2019** for each user:

* Adds **1** for each order in 2019
* Adds **0** for all other orders
* `SUM` gives the total count of 2019 orders per user.


### 3. `FROM Users u`

Uses the **Users** table as the base table with alias **`u`**.


### 4. `LEFT JOIN Orders o ON u.user_id = o.buyer_id`

Joins the **Orders** table to Users:

* Includes **all users**, even those who placed **no orders**.
* Matches users with their orders using `user_id = buyer_id`.


### 5. `GROUP BY u.user_id, u.join_date`

Groups records by **each user**, so the order count is calculated **per user**.


### 6. `ORDER BY u.user_id`

Sorts the final result in **ascending order of user ID**.


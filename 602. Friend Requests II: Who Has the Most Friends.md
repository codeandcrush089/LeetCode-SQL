# Problem 602: Friend Requests II: Who Has the Most Friends
![Medium](https://img.shields.io/badge/Level-Medium-yellow)

```sql
SELECT
    id,
    COUNT(*) AS num
FROM
    (
        -- Get all requesters
        SELECT requester_id AS id FROM RequestAccepted
        UNION ALL
        -- Get all accepters
        SELECT accepter_id AS id FROM RequestAccepted
    ) AS AllFriendships
GROUP BY
    id
ORDER BY
    num DESC
LIMIT 1;
```
---
## üßê Query Explanation

### **1. Subquery `AllFriendships`**

```sql
SELECT requester_id AS id FROM RequestAccepted
UNION ALL
SELECT accepter_id AS id FROM RequestAccepted
```

* Collects **all users involved in friendships**.
* Includes users both as:

  * **requesters**
  * **accepters**
* `UNION ALL` keeps **all occurrences** (no deduplication).


### **2. `GROUP BY id`**

Groups all friendship records by user ID.


### **3. `COUNT(*) AS num`**

Counts how many times each user appears ‚Üí **number of friends**.


### **4. `ORDER BY num DESC`**

Sorts users by **friend count**, highest first.


### **5. `LIMIT 1`**

Returns the **user with the most friends**.


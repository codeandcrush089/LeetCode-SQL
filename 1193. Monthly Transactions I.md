# Problem 1193: Monthly Transactions I
![Medium](https://img.shields.io/badge/Level-Medium-yellow?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/monthly-transactions-i/description/)

```sql
SELECT
    -- Extract the month in 'YYYY-MM' format for grouping and display
    DATE_FORMAT(trans_date, '%Y-%m') AS month,
    country,
    -- Total number of transactions for the month/country
    COUNT(id) AS trans_count,
    -- Total approved transactions: COUNT only when state is 'approved'
    SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count,
    -- Total amount of all transactions
    SUM(amount) AS trans_total_amount,
    -- Total amount of approved transactions: SUM amount only when state is 'approved'
    SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount
FROM
    Transactions
GROUP BY
    month, -- Group by the extracted month
    country
ORDER BY
    month, country; -- Optional: Order for better readability
```
---
## üßê Query Explanation

### 1. `SELECT DATE_FORMAT(trans_date, '%Y-%m') AS month`

Extracts the **year and month (YYYY-MM)** from `trans_date` and labels it as **`month`** for grouping and display.


### 2. `SELECT country`

Selects the **country** for each group.


### 3. `COUNT(id) AS trans_count`

Counts the **total number of transactions** for each **month‚Äìcountry** combination.


### 4. `SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count`

Counts only the **transactions with state = 'approved'** for each group.


### 5. `SUM(amount) AS trans_total_amount`

Calculates the **total transaction amount** (approved + non-approved) for each **month‚Äìcountry** group.


### 6. `SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount`

Calculates the **total amount of only approved transactions** for each group.


### 7. `FROM Transactions`

Uses the **Transactions** table as the data source.


### 8. `GROUP BY month, country`

Groups all records by:

* Extracted **month**
* **Country**
  So all aggregations are calculated **per month per country**.


### 9. `ORDER BY month, country`

Sorts the final result by **month first and then country** for better readability.


### ‚úÖ Final Outcome

Returns **monthly transaction statistics per country**, including total transactions, approved transaction count, total amount, and approved total amount.

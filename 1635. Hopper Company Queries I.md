# Problem 1635: Hopper Company Queries I
![Hard](https://img.shields.io/badge/Level-Hard-red)


```sql
WITH RECURSIVE
  Calendar AS (
    SELECT 1 AS month
    UNION ALL
    SELECT month + 1
    FROM Calendar
    WHERE month < 12
  )
SELECT
  Calendar.month,
  (
    SELECT COUNT(*)
    FROM Drivers
    WHERE
      YEAR(Drivers.join_date) < '2020'
      OR (
        YEAR(Drivers.join_date) = '2020'
        AND MONTH(Drivers.join_date) <= Calendar.month)
  ) AS active_drivers,
  (
    SELECT COUNT(*)
    FROM AcceptedRides
    INNER JOIN Rides
      USING (ride_id)
    WHERE
      YEAR(Rides.requested_at) = '2020'
      AND MONTH(Rides.requested_at) = Calendar.month
  ) AS accepted_rides
FROM Calendar;
```

## ðŸ§ Query Explanation

* `WITH RECURSIVE Calendar` â†’ Creates a list of **months from 1 to 12**.
* **First subquery (active_drivers)** â†’ Counts drivers who **joined before or up to each month of 2020**.
* `YEAR(join_date)` & `MONTH(join_date)` â†’ Filters drivers **month-wise for 2020**.
* **Second subquery (accepted_rides)** â†’ Counts rides **accepted in each month of 2020**.
* `INNER JOIN AcceptedRides USING (ride_id)` â†’ Matches **only accepted rides**.
* `Calendar.month` â†’ Ensures results are shown **for every month (Janâ€“Dec)**.



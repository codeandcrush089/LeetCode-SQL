# Problem 1767: Find the Subtasks That Did Not Execute

![Hard](https://img.shields.io/badge/Level-Hard-red?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/find-the-subtasks-that-did-not-execute/description/)

```sql
WITH RECURSIVE
  TaskToSubtask AS (
    SELECT task_id, subtasks_count AS subtask_id FROM Tasks
    UNION ALL
    SELECT task_id, subtask_id - 1 FROM TaskToSubtask
    WHERE subtask_id > 1
  )
SELECT * FROM TaskToSubtask
EXCEPT
SELECT * FROM Executed;
```
---
## üßê Query Explanation

* `WITH RECURSIVE TaskToSubtask AS (...)` ‚Üí Creates a **recursive CTE** to generate all subtask IDs for each task.
* `SELECT task_id, subtasks_count AS subtask_id FROM Tasks` ‚Üí Starts with the **maximum subtask number** for each task.
* `UNION ALL` + recursive query ‚Üí Keeps **decreasing subtask_id by 1** until it reaches 1.
* Result of CTE ‚Üí Produces **all (task_id, subtask_id) combinations** that *should exist*.
* `EXCEPT SELECT * FROM Executed` ‚Üí Removes the **already executed subtasks**.


# Problems 1661: Average Time of Process per Machine
![Easy](https://img.shields.io/badge/Level-Easy-brightgreen?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/average-time-of-process-per-machine/description/)

```sql
SELECT
    A_start.machine_id,
    -- Calculate the average time taken for a process on this machine.
    -- The time for one process is: A_end.timestamp - A_start.timestamp
    -- AVG() is applied to this difference across all processes for the machine.
    -- The result is rounded to 3 decimal places.
    ROUND(
        AVG(A_end.timestamp - A_start.timestamp),
        3
    ) AS processing_time
FROM
    -- Alias one instance of the table for the 'start' activity
    Activity AS A_start
JOIN
    -- Alias a second instance of the table for the 'end' activity
    Activity AS A_end
    -- Join condition ensures we match the 'start' and 'end' for the same process
    ON A_start.machine_id = A_end.machine_id
    AND A_start.process_id = A_end.process_id
WHERE
    -- Filter to ensure the first instance is the 'start' record
    A_start.activity_type = 'start'
    -- And the second instance is the 'end' record
    AND A_end.activity_type = 'end'
GROUP BY
    A_start.machine_id
-- The result can be returned in any order, so no final ORDER BY is strictly required.
;
```

## üßê Query Explanation

* `Activity AS A_start` & `Activity AS A_end` ‚Üí Same table used **twice** to match **start** and **end** records.
* `ON machine_id & process_id` ‚Üí Joins **start and end of the same process on the same machine**.
* `A_end.timestamp - A_start.timestamp` ‚Üí Calculates **time taken for one process**.
* `AVG(...)` ‚Üí Finds the **average processing time per machine**.
* `ROUND(..., 3)` ‚Üí Rounds the result to **3 decimal places**.
* `GROUP BY A_start.machine_id` ‚Üí Groups calculation **machine-wise**.



```sql
WITH DailyTotal AS (
    -- 1. Calculate the total amount paid by all customers on each visited_on date.
    SELECT
        visited_on,
        SUM(amount) AS daily_amount
    FROM
        Customer
    GROUP BY
        visited_on
),
MovingAverageCalc AS (
    -- 2. Calculate the 7-day moving sum and average using a window function.
    SELECT
        visited_on,
        -- Calculate the sum of daily_amount over the 7-day window.
        SUM(daily_amount) OVER (
            ORDER BY visited_on
            -- Defines the window as the current row and the 6 preceding rows,
            -- effectively covering 7 days (D-6 to D).
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS amount,
        -- Calculate the average, rounded to 2 decimal places.
        ROUND(
            AVG(daily_amount) OVER (
                ORDER BY visited_on
                ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ), 
            2
        ) AS average_amount,
        -- Find the minimum visited_on date for the filtering step.
        MIN(visited_on) OVER () AS first_visited_on
    FROM
        DailyTotal
)
-- 3. Filter the results to include only days where a full 7-day window is available.
SELECT
    visited_on,
    amount,
    average_amount
FROM
    MovingAverageCalc
WHERE
    -- A full 7-day window (D-6 to D) exists only for days
    -- that are 6 days or more after the first recorded date.
    visited_on >= DATE_ADD(first_visited_on, INTERVAL 6 DAY)
ORDER BY
    visited_on;
```

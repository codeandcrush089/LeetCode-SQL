# Problem 3611: Find Overbooked Employees
![Medium](https://img.shields.io/badge/Level-Medium-yellow)

```sql
WITH
    week_meeting_hours AS (
        SELECT
            employee_id,
            YEAR(meeting_date) AS year,
            WEEK(meeting_date, 1) AS week,
            SUM(duration_hours) hours
        FROM meetings
        GROUP BY 1, 2, 3
    ),
    intensive_weeks AS (
        SELECT
            employee_id,
            employee_name,
            department,
            count(1) AS meeting_heavy_weeks
        FROM
            week_meeting_hours
            JOIN employees USING (employee_id)
        WHERE hours >= 20
        GROUP BY 1
    )
SELECT employee_id, employee_name, department, meeting_heavy_weeks
FROM intensive_weeks
WHERE meeting_heavy_weeks >= 2
ORDER BY 4 DESC, 2;
```
---

## üßê Query Explanation
* **`week_meeting_hours` CTE**

  * Groups meetings by employee, year, and ISO week number.
  * `SUM(duration_hours)` gives **total hours spent in meetings per week**.

* **`intensive_weeks` CTE**

  * Joins the weekly hours to the `employees` table.
  * Counts how many weeks each employee spent **20+ hours in meetings**.
  * `meeting_heavy_weeks` = number of such intense weeks.

* **Final SELECT**

  * Shows employees who had **at least 2 meeting-heavy weeks**.
  * Ordered by:

    * `meeting_heavy_weeks` (descending),
    * `employee_name`.


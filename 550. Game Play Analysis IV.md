# Problem 550: Game Play Analysis IV
![Medium](https://img.shields.io/badge/Level-Medium-yellow)

```sql
WITH PlayerFirstLogin AS (
    -- Step 1: Find the initial login date for each player.
    SELECT
        player_id,
        MIN(event_date) AS first_login
    FROM
        Activity
    GROUP BY
        player_id
),
ReloggingPlayers AS (
    -- Step 2: Identify the distinct players who logged in again on the next day.
    SELECT DISTINCT
        T1.player_id
    FROM
        PlayerFirstLogin T1
    INNER JOIN
        Activity T2
    ON
        T1.player_id = T2.player_id
    -- Check if the subsequent event_date (T2) is exactly 1 day after the first login (T1).
    -- DATE_ADD is used here for standard date arithmetic in many SQL dialects (e.g., MySQL).
    WHERE
        T2.event_date = DATE_ADD(T1.first_login, INTERVAL 1 DAY)
)
-- Step 3: Calculate the fraction.
SELECT
    -- Calculate the ratio: (Count of relogging players) / (Total number of players).
    -- Multiplying by 1.0 ensures floating-point division for accurate rounding.
    ROUND(
        (SELECT COUNT(player_id) FROM ReloggingPlayers) * 1.0 
        / (SELECT COUNT(player_id) FROM PlayerFirstLogin), 
        2
    ) AS fraction;
```
---
## üßê Query Explanation

### **1. `PlayerFirstLogin` CTE**

* Groups records by `player_id`.
* Uses `MIN(event_date)` to get each player‚Äôs **first login date**.



### **2. `ReloggingPlayers` CTE**

* Joins first login data with the `Activity` table.
* Keeps players whose `event_date` is **exactly one day after** their first login.
* `DISTINCT` ensures each player is counted once.



### **3. Final SELECT**

* Numerator ‚Üí number of players who logged in again the next day.
* Denominator ‚Üí total number of players.
* `* 1.0` forces **decimal division**.
* `ROUND(..., 2)` rounds the result to **two decimals**.


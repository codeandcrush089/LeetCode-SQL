# Problem 1412: Find the Quiet Students in All Exams
![Hard](https://img.shields.io/badge/Level-Hard-red)

```sql
WITH
  RankedStudents AS (
    SELECT
      student_id,
      RANK() OVER(PARTITION BY exam_id ORDER BY score ASC) rank_asc,
      RANK() OVER(PARTITION BY exam_id ORDER BY score DESC) rank_desc
    FROM Exam
  )
SELECT * FROM Student
WHERE student_id IN (
  SELECT student_id FROM RankedStudents
  GROUP BY 1
  HAVING MIN(rank_asc) > 1 AND MIN(rank_desc) > 1
)
ORDER BY student_id;
```
---
## ðŸ§ Query Explanation

* `RANK() OVER (PARTITION BY exam_id ORDER BY score ASC)` â†’ Rank students **per exam** from **lowest score to highest**.
* `RANK() OVER (PARTITION BY exam_id ORDER BY score DESC)` â†’ Rank students **per exam** from **highest score to lowest**.
* `RankedStudents` CTE â†’ Stores each studentâ€™s **best (min) position** from both sides (low and high) in each exam.
* `GROUP BY student_id` + `HAVING MIN(rank_asc) > 1` â†’ Student was **never rank 1 on lowest score** (so never had the **lowest score** in any exam).
* `HAVING MIN(rank_desc) > 1` â†’ Student was **never rank 1 on highest score** (so never had the **highest score** in any exam).
* `WHERE student_id IN (...)` â†’ Keep only such students from the **Student** table.
* `ORDER BY student_id` â†’ Sort the final list by **student_id**.



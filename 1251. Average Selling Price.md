```sql
SELECT
    p.product_id,
    -- Calculate the weighted average price: SUM(Revenue) / SUM(Units)
    -- COALESCE handles products with 0 sales (where SUM(u.units) would be NULL), setting the price to 0.
    ROUND(
        COALESCE(
            CAST(SUM(p.price * u.units) AS DECIMAL) / SUM(u.units),
            0.00
        )
    , 2) AS average_price
FROM
    Prices p
LEFT JOIN
    UnitsSold u
    -- 1. Match on product ID
    ON p.product_id = u.product_id
    -- 2. Ensure the purchase date falls within the price period
    AND u.purchase_date BETWEEN p.start_date AND p.end_date
GROUP BY
    p.product_id;
```

# Problems 1747: Leetflex Banned Accounts

![Medium](https://img.shields.io/badge/Level-Medium-yellow)

```sql
WITH
  LogInfoNeighbors AS (
    SELECT
      *,
      LEAD(ip_address) OVER(
        PARTITION BY account_id
        ORDER BY login
      ) AS next_ip_address,
      LEAD(login) OVER(
        PARTITION BY account_id
        ORDER BY login
      ) next_login
    FROM LogInfo
  )
SELECT DISTINCT account_id
FROM LogInfoNeighbors
WHERE
  next_login <= logout
  AND ip_address != next_ip_address;
```

## ðŸ§ Query Explanation


* `FROM Products` â†’ Reads data from the **Products** table.
* `low_fats = 'Y'` â†’ Selects only **low-fat products**.
* `recyclable = 'Y'` â†’ Selects only **recyclable products**.
* `AND` â†’ Ensures **both conditions must be true**.
* `SELECT product_id` â†’ Returns only the **product IDs**.


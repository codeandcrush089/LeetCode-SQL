```sql
SELECT
    -- Calculate the percentage: (Count of Immediate First Orders / Total Customers) * 100
    ROUND(
        SUM(CASE
            WHEN t1.order_date = t1.customer_pref_delivery_date THEN 1
            ELSE 0
        END) * 100.0 / COUNT(t1.customer_id)
    , 2) AS immediate_percentage
FROM
    Delivery t1
INNER JOIN
    (
        -- Subquery to find the earliest order date for each customer
        SELECT
            customer_id,
            MIN(order_date) AS first_order_date
        FROM
            Delivery
        GROUP BY
            customer_id
    ) AS t2
ON
    t1.customer_id = t2.customer_id AND t1.order_date = t2.first_order_date;
```



## üßê Query Breakdown

1.  **Find the First Order Date (`t2` Subquery):**

      * The inner subquery `t2` groups the `Delivery` table by `customer_id` and uses `MIN(order_date)` to find the earliest order date for every customer.

2.  **Filter for First Orders (JOIN):**

      * The main query joins the `Delivery` table (`t1`) with the results of `t2` on two conditions:
          * `t1.customer_id = t2.customer_id`: Matches the customer.
          * `t1.order_date = t2.first_order_date`: **Crucially, this ensures that only the rows corresponding to the customer's very first order are selected.**

3.  **Conditional Aggregation (SUM and COUNT):**

      * **Numerator (Immediate Orders):** The `SUM(CASE WHEN ... THEN 1 ELSE 0 END)` expression counts the number of immediate first orders. An order is **immediate** if `t1.order_date = t1.customer_pref_delivery_date`.
      * **Denominator (Total Customers):** `COUNT(t1.customer_id)` counts the total number of distinct first orders, which is equal to the total number of customers, given the problem statement guarantees each customer has precisely one first order.
      * **Calculation:** The calculation `(Immediate Count * 100.0 / Total Customers)` computes the percentage. We multiply by `100.0` to ensure floating-point division.

4.  **Formatting:**

      * `ROUND(..., 2) AS immediate_percentage`: The final result is rounded to 2 decimal places as requested.


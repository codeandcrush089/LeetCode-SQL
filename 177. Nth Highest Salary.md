# Problem 177: Nth Highest Salary
![Medium](https://img.shields.io/badge/Level-Medium-yellow?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/nth-highest-salary/description/)

```sql
CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
BEGIN
  -- Calculate the offset required for the Nth highest element (N-1).
  -- If N=1, OFFSET is 0 (the 1st element).
  -- If N=2, OFFSET is 1 (the 2nd element).
  DECLARE offset_val INT;
  SET offset_val = N - 1;

  RETURN (
      SELECT DISTINCT salary
      FROM Employee
      -- Order salaries in descending order
      ORDER BY salary DESC
      -- Retrieve only one row (LIMIT 1) starting from the calculated offset.
      -- If N is larger than the number of distinct salaries, this subquery returns an empty set,
      -- and the function correctly returns NULL.
      LIMIT 1 OFFSET offset_val
  );
END
```
---
## üßê Query Explanation

### **1. Declare and compute the offset**

```sql
DECLARE offset_val INT;
SET offset_val = N - 1;
```

* The N-th highest salary corresponds to `OFFSET = N - 1`.

  * Example: N = 1 ‚Üí offset 0 ‚Üí highest salary
  * N = 3 ‚Üí offset 2 ‚Üí third highest salary



### **2. Return the N-th highest distinct salary**

```sql
RETURN (
    SELECT DISTINCT salary
    FROM Employee
    ORDER BY salary DESC
    LIMIT 1 OFFSET offset_val
);
```

* `DISTINCT salary` ‚Üí ensures duplicates don‚Äôt affect ranking.
* `ORDER BY salary DESC` ‚Üí sorts from highest to lowest.
* `LIMIT 1 OFFSET offset_val` ‚Üí picks exactly the **Nth** highest salary.
* If N is larger than the number of distinct salaries ‚Üí returns **NULL**, which is correct.


# Problem 3570: Find Books with No Available Copies
![Easy](https://img.shields.io/badge/Level-Easy-brightgreen)

```sql
WITH
    T AS (
        SELECT book_id, COUNT(1) current_borrowers
        FROM borrowing_records
        WHERE return_date IS NULL
        GROUP BY 1
    )
SELECT book_id, title, author, genre, publication_year, current_borrowers
FROM
    library_books
    JOIN T USING (book_id)
WHERE current_borrowers = total_copies
ORDER BY 6 DESC, 2;

```
---
## üßê Query Explanation


* **`T` CTE**

  * Counts how many borrowers currently have each book checked out.
  * `return_date IS NULL` ‚Üí only books **not yet returned**.
  * Produces: `book_id`, `current_borrowers`.

* **Main query**

  * Joins `library_books` with `T` to match each book with its current borrower count.
  * `WHERE current_borrowers = total_copies`
    ‚Üí Selects books where **every copy is currently borrowed** (i.e., the book is fully checked out / unavailable).
  * `ORDER BY 6 DESC, 2`
    ‚Üí Order by `current_borrowers` (column 6) descending, then by `title`.


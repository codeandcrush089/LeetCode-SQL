# Problem 569: Median Employee Salary
![Hard](https://img.shields.io/badge/Level-Hard-red?style=for-the-badge) [![Problem Link](https://img.shields.io/badge/LeetCode-Link-orange?style=for-the-badge&logo=leetcode)](https://leetcode.com/problems/median-employee-salary/description/)

```sql
WITH
  EmployeesWithRowNumberInCompany AS (
    SELECT
      id,
      company,
      salary,
      ROW_NUMBER() OVER(
        PARTITION BY company
        ORDER BY salary
      ) AS `row_number`,
      COUNT(*) OVER(PARTITION BY company) AS `count`
    FROM Employee
  )
SELECT id, company, salary
FROM EmployeesWithRowNumberInCompany
WHERE
  `row_number` >= `count` / 2
  AND `row_number` <= `count` / 2 + 1;
```
---
## ðŸ§ Query Explanation

* `ROW_NUMBER() OVER(PARTITION BY company ORDER BY salary)`
  â†’ Assigns a **salary rank within each company** (lowest to highest).

* `COUNT(*) OVER(PARTITION BY company)`
  â†’ Gets the **total number of employees per company**.

* `WHERE row_number >= count/2 AND row_number <= count/2 + 1`
  â†’ Selects the **middle one (odd count)** or **two middle employees (even count)**.

* `SELECT id, company, salary`
  â†’ Returns only the **employee ID, company, and salary**.



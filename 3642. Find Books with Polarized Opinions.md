# Problem 3642: Find Books with Polarized Opinions
![Easy](https://img.shields.io/badge/Level-Easy-brightgreen)

```sql
SELECT
    book_id,
    title,
    author,
    genre,
    pages,
    (MAX(session_rating) - MIN(session_rating)) AS rating_spread,
    ROUND((SUM(session_rating <= 2) + SUM(session_rating >= 4)) / COUNT(1), 2) polarization_score
FROM
    books
    JOIN reading_sessions USING (book_id)
GROUP BY book_id
HAVING
    COUNT(1) >= 5
    AND MAX(session_rating) >= 4
    AND MIN(session_rating) <= 2
    AND polarization_score >= 0.6
ORDER BY polarization_score DESC, title DESC;
```
---
## üßê Query Explanation

* The query joins `books` with their `reading_sessions`.

* **Aggregate metrics per book:**

  * `rating_spread = MAX(session_rating) - MIN(session_rating)`
    ‚Üí Measures how far apart the highest and lowest ratings are.
  * `SUM(session_rating <= 2)` ‚Üí Counts **low ratings**.
  * `SUM(session_rating >= 4)` ‚Üí Counts **high ratings**.
  * `polarization_score` = (low + high ratings) / total sessions
    ‚Üí Percentage of *polarized* ratings (either very low or very high).

* **HAVING filters ensure:**

  * `COUNT(1) >= 5` ‚Üí Book has at least **5 reading sessions**.
  * `MAX(session_rating) >= 4` ‚Üí Book was rated **high** by someone.
  * `MIN(session_rating) <= 2` ‚Üí Book was rated **low** by someone.
  * `polarization_score >= 0.6` ‚Üí At least **60% of ratings are polarized**.

* Results are ordered by highest polarization first, then by title.



```sql
WITH RunningWeights AS (
    SELECT
        person_name,
        turn,
        -- Calculate the cumulative weight as people board the bus in turn order
        SUM(weight) OVER (ORDER BY turn ASC) AS total_weight
    FROM
        Queue
)
SELECT
    person_name
FROM
    RunningWeights
WHERE
    total_weight <= 1000 -- Filter for all people who can board
ORDER BY
    turn DESC -- Order by turn descending to find the last person
LIMIT 1; -- Select only the top result (the last person who boarded)
```

## ðŸ’¡ Query Breakdown

1.  **`WITH RunningWeights AS (...)` (Common Table Expression):**

      * This CTE first sorts the queue by the `turn` column.
      * **`SUM(weight) OVER (ORDER BY turn ASC) AS total_weight`**: This is the core of the solution. It uses a **window function** to calculate the **cumulative sum** (running total) of weights. For each person, `total_weight` represents the combined weight of themselves and everyone who boarded before them.

2.  **Outer `SELECT` Statement:**

      * **`WHERE total_weight <= 1000`**: This filters the results to include only the people whose cumulative weight does not exceed the bus limit.
      * **`ORDER BY turn DESC`**: We order the remaining eligible people by their `turn` in descending order.
      * **`LIMIT 1`**: This selects the first record in the descending list, which corresponds to the person with the largest `turn` number (i.e., the **last person** who successfully boarded).
